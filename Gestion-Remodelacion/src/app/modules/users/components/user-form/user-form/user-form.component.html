<h2 mat-dialog-title>{{ (isEditMode ? 'USERS.EDIT_USER' : 'USERS.CREATE_USER') | translate }}</h2>

<form [formGroup]="userForm" (ngSubmit)="onSubmit()">
    <mat-dialog-content>
        <mat-form-field appearance="outline" class="full-width">
            <mat-label>{{ 'USERS.USERNAME' | translate }}</mat-label>
            <input matInput formControlName="username" required />
            <mat-error *ngIf="userForm.get('username')?.hasError('required') && userForm.get('username')?.touched">
                {{ 'USERS.USERNAME_REQUIRED' | translate }}
            </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width" *ngIf="!isEditMode">
            <mat-label>{{ 'USERS.PASSWORD' | translate }}</mat-label>
            <input matInput type="password" formControlName="password" [required]="!isEditMode" />
            <mat-error *ngIf="userForm.get('password')?.hasError('required') && userForm.get('password')?.touched">
                {{ 'USERS.PASSWORD_REQUIRED' | translate }}
            </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width" *ngIf="isSuperAdmin">
            <mat-label>{{ 'GLOBAL.COMPANY' | translate }}</mat-label>
            <mat-select formControlName="empresaId" required>
                <mat-option *ngFor="let empresa of empresas" [value]="empresa.id">
                    {{ empresa.nombreEmpresa }}
                </mat-option>
            </mat-select>
            <mat-error *ngIf="userForm.get('empresaId')?.hasError('required') && userForm.get('empresaId')?.touched">
                {{ 'USERS.COMPANY_REQUIRED' | translate }}
            </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>{{ 'USERS.ROLES' | translate }}</mat-label>    
            <mat-select formControlName="roles" multiple required>
                <mat-option *ngFor="let role of roles" [value]="role.id">{{ role.name | uppercase }}</mat-option>
            </mat-select>
            <mat-error *ngIf="userForm.get('roles')?.hasError('required') && userForm.get('roles')?.touched">
                {{ 'USERS.ROLES_REQUIRED' | translate }}      
            </mat-error>
        </mat-form-field>

        <mat-checkbox formControlName="enabled" class="checkbox-spacing">
            {{ 'USERS.IS_ACTIVE' | translate }}
        </mat-checkbox>
    </mat-dialog-content>

    <mat-dialog-actions align="end">
        <button mat-button type="button" (click)="onCancel()">{{ 'GLOBAL.CANCEL' | translate }}</button>
        <button mat-raised-button color="primary" type="submit" [disabled]="userForm.invalid">
            {{ (isEditMode ? 'GLOBAL.UPDATE' : 'GLOBAL.CREATE') | translate }}
        </button>
    </mat-dialog-actions>
</form>